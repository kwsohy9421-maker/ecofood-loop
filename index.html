<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CleanWave Edu â€” í™˜ê²½ í”„ë¡œê·¸ë¨ ì‹ ì²­</title>

  <!-- Noto Sans KR -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f7fbfc;
      --card:#ffffff;
      --mint:#4ec4c4;
      --sky:#6ecff6;
      --accent:#ffe380;
      --text:#2e3a3f;
      --muted:#6b7380;
      --shadow: 0 6px 22px rgba(29,41,51,0.08);
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Noto Sans KR",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }

    /* Header */
    header{
      position:fixed;
      left:0;right:0;top:0;
      height:68px;
      background:rgba(255,255,255,0.9);
      backdrop-filter: blur(6px);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:12px 28px;
      box-shadow: 0 1px 0 rgba(16,24,32,0.04);
      z-index:200;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:44px;height:44px;border-radius:10px;
      background:linear-gradient(135deg,var(--mint),var(--sky));
      display:flex;align-items:center;justify-content:center;color:white;font-weight:700;
      box-shadow: 0 4px 12px rgba(78,196,196,0.18);
    }
    .brand h1{font-size:18px;margin:0;color:var(--mint)}
    nav{display:flex;gap:16px;align-items:center}
    nav a{color:var(--text);text-decoration:none;font-weight:500;font-size:14px}
    nav a:hover{color:var(--sky)}

    /* Main layout */
    main{padding-top:88px}
    .hero{
      padding:56px 24px;
      display:flex;
      gap:28px;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      text-align:center;
    }
    .hero .eyebrow{background:linear-gradient(90deg,var(--mint),var(--sky));color:white;padding:6px 12px;border-radius:999px;font-weight:700;font-size:13px;display:inline-block}
    .hero h2{font-size:34px;margin:18px 0 8px;color:var(--text)}
    .hero p{color:var(--muted);max-width:880px;margin:0 auto;font-size:16px}

    .hero .cta{margin-top:20px;display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
    .btn{background:var(--mint);color:white;padding:12px 18px;border-radius:12px;border:0;font-weight:700;cursor:pointer;box-shadow:var(--shadow)}
    .btn.secondary{background:#fff;color:var(--mint);border:1px solid #e7f4f4}

    /* feature / intro */
    .features{padding:30px 24px;max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1fr 1fr 1fr;gap:18px}
    .feature{
      background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.04);
    }
    .feature h3{margin:0 0 8px;color:var(--mint)}
    .feature p{margin:0;color:var(--muted);font-size:14px}

    /* Program Dashboard */
    #programDashboard{padding:36px 24px 80px}
    #programDashboard .topbar{
      max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;
    }
    .selected-badges{
      display:flex;gap:8px;flex-wrap:wrap;align-items:center;
      max-width:70%;
    }
    .badge{
      background:linear-gradient(90deg,rgba(110,207,246,0.12),rgba(78,196,196,0.08));
      border:1px solid rgba(78,196,196,0.12);
      color:var(--mint);
      padding:8px 12px;border-radius:999px;font-weight:600;font-size:13px;
      display:inline-flex;gap:8px;align-items:center;
    }
    .badge .x{cursor:pointer;background:transparent;border:0;color:var(--mint);font-weight:700}
    .selection-count{color:var(--muted);font-size:14px}

    .dashboard-container{
      max-width:1200px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px;
    }

    .dash-card{
      background:var(--card);padding:18px;border-radius:16px;box-shadow:var(--shadow);
      position:relative;border:3px solid transparent;cursor:pointer;transition:all .22s;
      display:flex;flex-direction:column;gap:8px;
    }
    .dash-card:hover{transform:translateY(-6px)}
    .dash-card .title{display:flex;align-items:center;gap:10px;font-weight:700;color:var(--mint);font-size:16px}
    .dash-card p{color:var(--muted);margin:0;font-size:14px}
    .dash-card .meta{font-size:13px;color:var(--muted);margin-top:auto}

    .dash-check{
      position:absolute;right:12px;top:12px;background:var(--sky);color:white;width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;display:none;
    }
    .dash-card.selected{border-color:rgba(110,207,246,0.8);background:linear-gradient(180deg,#f1fcff,#ffffff)}
    .dash-card.selected .dash-check{display:flex}

    .dash-actions{max-width:1200px;margin:22px auto 0;display:flex;gap:12px;align-items:center;justify-content:flex-end;padding-right:6px}
    .tag-list{display:flex;gap:8px;flex-wrap:wrap;align-items:center}

    /* Details modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(12,20,24,0.45);display:none;align-items:center;justify-content:center;z-index:300;padding:20px}
    .modal{background:white;border-radius:16px;max-width:920px;width:100%;max-height:90vh;overflow:auto;padding:20px;box-shadow:0 20px 50px rgba(0,0,0,0.25)}
    .modal header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px}
    .modal h3{margin:0;color:var(--mint)}
    .modal .close{background:transparent;border:0;font-size:20px;cursor:pointer}
    .program-detail{display:grid;grid-template-columns:1fr;gap:12px}
    .detail-block{background:#fbfdff;padding:14px;border-radius:10px;border:1px solid #eef8fb}
    .detail-block h4{margin:0 0 6px;color:var(--text)}
    .detail-block p, .detail-block ul{margin:0;color:var(--muted);font-size:14px}
    .detail-block ul{margin-top:8px;padding-left:18px}

    /* Form modal */
    .form-row{display:flex;gap:12px;flex-wrap:wrap}
    .form-control{flex:1;min-width:160px;display:flex;flex-direction:column;gap:8px;margin-bottom:8px}
    label{font-size:13px;color:var(--muted)}
    input[type=text], input[type=email], textarea, select{
      padding:10px;border-radius:10px;border:1px solid #e6eef0;background:#fff;
      font-size:14px;color:var(--text)
    }
    textarea{min-height:100px;resize:vertical;padding:12px}
    .submit-row{display:flex;gap:10px;justify-content:flex-end;margin-top:8px}

    /* Summary / download */
    .summary{background:#f6fdff;border:1px solid #e1f7ff;padding:12px;border-radius:10px;color:var(--muted);font-size:14px}

    /* footer */
    footer{padding:30px 18px;text-align:center;color:var(--muted);font-size:14px;margin-top:28px}

    /* responsive */
    @media(max-width:900px){
      .features{grid-template-columns:1fr}
      .hero h2{font-size:28px}
      .dash-card{padding:14px}
    }
  </style>
</head>
<body>

<header role="banner">
  <div class="brand">
    <div class="logo" aria-hidden="true">CW</div>
    <div>
      <h1>CleanWave Edu</h1>
      <div style="font-size:12px;color:var(--muted)">ì²­ì†Œë…„ í™˜ê²½ ì‹¤ì²œ í”„ë¡œê·¸ë¨</div>
    </div>
  </div>

  <nav role="navigation" aria-label="ì£¼ìš” ì„¹ì…˜">
    <a href="#hero">í™ˆ</a>
    <a href="#features">í•µì‹¬</a>
    <a href="#programDashboard">í”„ë¡œê·¸ë¨</a>
    <a href="#news">ë‰´ìŠ¤</a>
  </nav>
</header>

<main>
  <section class="hero" id="hero" aria-labelledby="hero-title">
    <div class="eyebrow">êµìœ¡ Â· ì°¸ì—¬ Â· ì‹¤ì²œ</div>
    <h2 id="hero-title">í•™êµì—ì„œ ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì‹¤ì „í˜• í™˜ê²½ í”„ë¡œê·¸ë¨</h2>
    <p>í´ë¦°ì›¨ì´ë¸Œì˜ 6ê°œ í•µì‹¬ í”„ë¡œê·¸ë¨ì€ ê³ ë“±í•™ìƒì´ ì‹¤ì œë¡œ ì°¸ì—¬í•˜ê³ , í•™êµì™€ ì§€ì—­ì‚¬íšŒì—ì„œ ìš´ì˜ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ê° í”„ë¡œê·¸ë¨ì„ ìì„¸íˆ ë³´ê³  ì—¬ëŸ¬ ê°œë¥¼ í•œ ë²ˆì— ì‹ ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    <div class="cta">
      <button class="btn" onclick="document.querySelector('#programDashboard').scrollIntoView({behavior:'smooth'})">í”„ë¡œê·¸ë¨ ë°”ë¡œë³´ê¸°</button>
      <button class="btn secondary" onclick="openApplyForm()">ë°”ë¡œ ì‹ ì²­í•˜ê¸°</button>
    </div>
  </section>

  <!-- features -->
  <section id="features" aria-labelledby="features-title">
    <div style="max-width:1200px;margin:0 auto">
      <h2 id="features-title">í•µì‹¬ í™œë™</h2>
      <div class="features" aria-hidden="false">
        <div class="feature">
          <h3>í™˜ê²½ êµìœ¡ ì½˜í…ì¸ </h3>
          <p>êµì‹¤ì—ì„œ ë°”ë¡œ í™œìš© ê°€ëŠ¥í•œ ëª¨ë“ˆí˜• ìˆ˜ì—… ìë£Œì™€ í€´ì¦ˆ, ì‹¤ìŠµ í™œë™ì§€ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
        </div>
        <div class="feature">
          <h3>í˜„ì¥ ì‹¤ì²œ</h3>
          <p>í•´ë³€ ì •í™”, ì—…ì‚¬ì´í´ë§ ì›Œí¬ìˆ, í•™êµ ì—ë„ˆì§€ ì¡°ì‚¬ ë“± ì§ì ‘ í–‰ë™ìœ¼ë¡œ ì´ì–´ì§€ëŠ” í™œë™.</p>
        </div>
        <div class="feature">
          <h3>ì„±ê³¼ ê³µìœ </h3>
          <p>í•™ìƒ í”„ë¡œì íŠ¸ ê²°ê³¼ë¥¼ ì „ì‹œÂ·ê³µìœ í•˜ì—¬ í•™êµ ì»¤ë®¤ë‹ˆí‹°ì™€ í™•ì‚°í•©ë‹ˆë‹¤.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Program Dashboard -->
  <section id="programDashboard" aria-labelledby="programDashboard-title">
    <div class="topbar">
      <div>
        <h2 id="programDashboard-title">í™˜ê²½ í”„ë¡œê·¸ë¨ ì„ íƒ</h2>
        <div class="selection-count" id="selectionCount">0ê°œ ì„ íƒë¨</div>
      </div>

      <div class="selected-badges" id="selectedBadges" aria-live="polite" aria-atomic="true">
        <!-- badges ì‚½ì… -->
      </div>
    </div>

    <div class="dashboard-container" id="dashboardContainer">
      <!-- ì¹´ë“œë“¤: data-program-idë¡œ ì‹ë³„ -->
      <div class="dash-card" data-id="p1" tabindex="0" role="button" aria-pressed="false" aria-label="íƒ„ì†Œ ì ˆê° ì‹ë‹¨ í”„ë¡œê·¸ë¨ ìƒì„¸ ë³´ê¸° ë° ì„ íƒ">
        <div class="dash-check">âœ”</div>
        <div class="title">ğŸ¥© íƒ„ì†Œ ì ˆê° ì‹ë‹¨ í”„ë¡œê·¸ë¨</div>
        <p>í•œ ë‹¬ê°„ ê¸°í›„ì‹ë‹¨ì„ ì‹¤ì²œí•˜ë©° íƒ„ì†Œ ë°œìêµ­ì„ ì¤„ì´ëŠ” ì²´í—˜í˜• í”„ë¡œì íŠ¸ (ë ˆì‹œí”¼Â·ë°ì´í„° ì œì¶œ í¬í•¨)</p>
        <div class="meta">ì‹¤í–‰ê¸°ê°„: 4ì£¼ Â· íŒ€/ê°œì¸ ì°¸ì—¬ ê°€ëŠ¥</div>
        <button class="btn" style="margin-top:10px" onclick="openDetail('p1', event)">ìì„¸íˆ ë³´ê¸°</button>
      </div>

      <div class="dash-card" data-id="p2" tabindex="0" role="button" aria-pressed="false" aria-label="ì œë¡œì›¨ì´ìŠ¤íŠ¸ ì‹¤ì²œ ì±Œë¦°ì§€ ìƒì„¸ ë³´ê¸° ë° ì„ íƒ">
        <div class="dash-check">âœ”</div>
        <div class="title">â™» ì œë¡œì›¨ì´ìŠ¤íŠ¸ ì‹¤ì²œ ì±Œë¦°ì§€</div>
        <p>í•™êµ ë‚´ ì¼íšŒìš© ì¤„ì´ê¸° ìº í˜ì¸(14ì¼) Â· ë¦¬í•„ìŠ¤í…Œì´ì…˜ ì œì•ˆì„œ ì œì‘ê¹Œì§€ í¬í•¨</p>
        <div class="meta">ì‹¤í–‰ê¸°ê°„: 14ì¼ Â· ë‹¨ì²´ ê¶Œì¥</div>
        <button class="btn" style="margin-top:10px" onclick="openDetail('p2', event)">ìì„¸íˆ ë³´ê¸°</button>
      </div>

      <div class="dash-card" data-id="p3" tabindex="0" role="button" aria-pressed="false" aria-label="íƒ„ì†Œ í¬ì¸íŠ¸ ì ë¦½ êµìœ¡ ìƒì„¸ ë³´ê¸° ë° ì„ íƒ">
        <div class="dash-check">âœ”</div>
        <div class="title">ğŸŒ± íƒ„ì†Œ í¬ì¸íŠ¸ ì ë¦½ êµìœ¡</div>
        <p>ìƒí™œ ë¯¸ì…˜ 10ì¢…ì„ í†µí•´ í¬ì¸íŠ¸ë¥¼ ì ë¦½í•˜ê³  ë³´ìƒìœ¼ë¡œ í™˜ê²½ êµ¿ì¦ˆ ì œê³µ</p>
        <div class="meta">ì‹¤í–‰ê¸°ê°„: ì—°ì†í˜•(ì±Œë¦°ì§€) Â· ê°œì¸ ì°¸ì—¬</div>
        <button class="btn" style="margin-top:10px" onclick="openDetail('p3', event)">ìì„¸íˆ ë³´ê¸°</button>
      </div>

      <div class="dash-card" data-id="p4" tabindex="0" role="button" aria-pressed="false" aria-label="í•´ì–‘ ë™ë¬¼ ë³´í˜¸ í”„ë¡œì íŠ¸ ìƒì„¸ ë³´ê¸° ë° ì„ íƒ">
        <div class="dash-check">âœ”</div>
        <div class="title">ğŸ¬ í•´ì–‘ ë™ë¬¼ ë³´í˜¸ í”„ë¡œì íŠ¸</div>
        <p>ì‹œë¯¼ê³¼í•™ ë°ì´í„° ìˆ˜ì§‘Â·ì—°ì•ˆ ì“°ë ˆê¸° ìˆ˜ê±°Â·ì „ì‹œê¹Œì§€ ì—°ê²°ë˜ëŠ” í™œë™(ë‹¨ì²´ ê¶Œì¥)</p>
        <div class="meta">ì‹¤í–‰ê¸°ê°„: 4ì£¼ Â· ì•¼ì™¸ í™œë™ í¬í•¨</div>
        <button class="btn" style="margin-top:10px" onclick="openDetail('p4', event)">ìì„¸íˆ ë³´ê¸°</button>
      </div>

      <div class="dash-card" data-id="p5" tabindex="0" role="button" aria-pressed="false" aria-label="í”Œë¼ìŠ¤í‹± ì¬ìˆœí™˜ ì•„íŠ¸ í”„ë¡œì íŠ¸ ìƒì„¸ ë³´ê¸° ë° ì„ íƒ">
        <div class="dash-check">âœ”</div>
        <div class="title">ğŸ¨ í”Œë¼ìŠ¤í‹± ì¬ìˆœí™˜ ì•„íŠ¸</div>
        <p>ìˆ˜ê±°í•œ í”Œë¼ìŠ¤í‹±ì„ ì‘í’ˆìœ¼ë¡œ ì¬íƒ„ìƒì‹œí‚¤ëŠ” ì—…ì‚¬ì´í´ë§ ë””ìì¸ ì±Œë¦°ì§€</p>
        <div class="meta">ì‹¤í–‰ê¸°ê°„: 2~4ì£¼ Â· íŒ€ í”„ë¡œì íŠ¸ ê¶Œì¥</div>
        <button class="btn" style="margin-top:10px" onclick="openDetail('p5', event)">ìì„¸íˆ ë³´ê¸°</button>
      </div>

      <div class="dash-card" data-id="p6" tabindex="0" role="button" aria-pressed="false" aria-label="íƒ„ì†Œì¤‘ë¦½ í•™êµ í”„ë¡œì íŠ¸ ìƒì„¸ ë³´ê¸° ë° ì„ íƒ">
        <div class="dash-check">âœ”</div>
        <div class="title">ğŸ« íƒ„ì†Œì¤‘ë¦½ í•™êµ í”„ë¡œì íŠ¸</div>
        <p>í•™êµ ì „ì²´ì˜ ì˜¨ì‹¤ê°€ìŠ¤ ìš”ì¸ì„ ë¶„ì„í•´ COâ‚‚ ì§€ë„ë¥¼ ë§Œë“¤ê³  ì‹¤í–‰ ê³„íšì„ ì œì•ˆí•©ë‹ˆë‹¤</p>
        <div class="meta">ì‹¤í–‰ê¸°ê°„: 4ì£¼ Â· í˜‘ì—…í˜•</div>
        <button class="btn" style="margin-top:10px" onclick="openDetail('p6', event)">ìì„¸íˆ ë³´ê¸°</button>
      </div>
    </div>

    <div class="dash-actions">
      <div class="tag-list" id="tagList" aria-hidden="false"></div>
      <div style="flex:1"></div>
      <button class="btn secondary" onclick="clearAll()">ì„ íƒ ì´ˆê¸°í™”</button>
      <button class="btn" onclick="openApplyForm()">ì„ íƒí•œ í”„ë¡œê·¸ë¨ ì‹ ì²­í•˜ê¸°</button>
    </div>
  </section>

  <!-- News -->
  <section id="news" aria-labelledby="news-title" style="padding:30px 24px">
    <div style="max-width:1200px;margin:0 auto">
      <h2 id="news-title">ë‰´ìŠ¤ & ìŠ¤í† ë¦¬</h2>
      <p style="color:var(--muted)">ìµœê·¼ í™œë™: 2025.10.10 ë¶€ì‚° í•´ìš´ëŒ€ ì •í™” ìº í˜ì¸ 1í†¤ ìˆ˜ê±° ë‹¬ì„± Â· 2025.09.20 ì²­ì†Œë…„ í™˜ê²½ ì˜ˆìˆ ì œ 'Plastic Reborn' ê°œìµœ</p>
    </div>
  </section>
</main>

<footer>
  Â© 2025 CleanWave Education Foundation Â· ë¬¸ì˜: cleanwave@edu.org Â· ì „í™”: 070-1234-5678
</footer>

<!-- ëª¨ë‹¬(ìƒì„¸/í¼) -->
<div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true" aria-modal="true">
  <div class="modal" role="document" aria-labelledby="modalTitle">
    <header>
      <h3 id="modalTitle">í”„ë¡œê·¸ë¨ ìƒì„¸</h3>
      <button class="close" aria-label="ë‹«ê¸°" onclick="closeModal()">âœ•</button>
    </header>

    <div id="modalContent">
      <!-- ìƒì„¸ ë‚´ìš©ì´ JSë¡œ ë“¤ì–´ê° -->
    </div>

    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
      <button class="btn secondary" onclick="closeModal()">ë‹«ê¸°</button>
      <button class="btn" id="modalSelectBtn" onclick="toggleSelectFromModal()">ì„ íƒ/í•´ì œ</button>
    </div>
  </div>
</div>

<!-- ì‹ ì²­ í¼ ëª¨ë‹¬ -->
<div id="formBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true" aria-modal="true">
  <div class="modal" role="document" aria-labelledby="formTitle">
    <header>
      <h3 id="formTitle">í”„ë¡œê·¸ë¨ ì‹ ì²­ì„œ</h3>
      <button class="close" aria-label="ë‹«ê¸°" onclick="closeForm()">âœ•</button>
    </header>

    <div>
      <div class="form-row">
        <div class="form-control">
          <label for="name">ì´ë¦„</label>
          <input id="name" type="text" placeholder="í™ê¸¸ë™" />
        </div>
        <div class="form-control">
          <label for="school">í•™êµ</label>
          <input id="school" type="text" placeholder="OOê³ ë“±í•™êµ" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-control">
          <label for="grade">í•™ë…„/ë°˜</label>
          <input id="grade" type="text" placeholder="1í•™ë…„ 2ë°˜" />
        </div>
        <div class="form-control">
          <label for="email">ì´ë©”ì¼</label>
          <input id="email" type="email" placeholder="name@example.com" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-control" style="flex:1">
          <label for="phone">ì „í™”ë²ˆí˜¸</label>
          <input id="phone" type="text" placeholder="010-1234-5678" />
        </div>
        <div class="form-control" style="flex:1">
          <label for="contactPref">ë¬¸ì˜ ë°©ë²•</label>
          <select id="contactPref">
            <option>ì´ë©”ì¼</option>
            <option>ì „í™”</option>
            <option>ë©”ì‹ ì €</option>
          </select>
        </div>
      </div>

      <div class="form-control">
        <label>ì„ íƒí•œ í”„ë¡œê·¸ë¨</label>
        <div id="formSelectedList" class="summary">ì•„ì§ ì„ íƒëœ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤.</div>
      </div>

      <div class="form-control">
        <label for="message">ì¶”ê°€ ë©”ì‹œì§€ (ì„ íƒ)</label>
        <textarea id="message" placeholder="í•™êµ ë‹´ë‹¹ì ì—°ë½ ê°€ëŠ¥ ì‹œê°„, ìš”ì²­ ì‚¬í•­ ë“±ì„ ì ì–´ì£¼ì„¸ìš”."></textarea>
      </div>

      <div class="submit-row">
        <button class="btn secondary" onclick="closeForm()">ì·¨ì†Œ</button>
        <button class="btn" onclick="submitApplication()">ì œì¶œí•˜ê¸°</button>
      </div>

      <div style="margin-top:12px;color:var(--muted);font-size:13px">
        ì œì¶œ ì‹œ í•™êµ ë‹´ë‹¹ì ì´ë©”ì¼ë¡œ ì ‘ìˆ˜ í™•ì¸ ë©”ì¼ì´ ë°œì†¡ë©ë‹ˆë‹¤. (ë°ëª¨ì—ì„œëŠ” ë¡œì»¬ì— ì €ì¥ ë° ë‹¤ìš´ë¡œë“œ ì œê³µ)
      </div>
    </div>
  </div>
</div>

<!-- ì œì¶œ í™•ì¸ ëª¨ë‹¬ -->
<div id="confirmBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
  <div class="modal" role="document">
    <header>
      <h3>ì‹ ì²­ ì ‘ìˆ˜ ì™„ë£Œ</h3>
      <button class="close" aria-label="ë‹«ê¸°" onclick="closeConfirm()">âœ•</button>
    </header>
    <div id="confirmContent">
      <!-- ìš”ì•½ í‘œì‹œ -->
    </div>
    <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:12px">
      <button class="btn secondary" onclick="closeConfirm()">ë‹«ê¸°</button>
      <button class="btn" id="downloadBtn" onclick="downloadSubmission()">ì‹ ì²­ì„œ ë‹¤ìš´ë¡œë“œ</button>
    </div>
  </div>
</div>

<script>
/* ---------- í”„ë¡œê·¸ë¨ ë°ì´í„° (ìƒì„¸ ë‚´ìš© í¬í•¨) ---------- */
const programs = {
  p1: {
    id:'p1',
    title:'ğŸ¥© íƒ„ì†Œ ì ˆê° ì‹ë‹¨ í”„ë¡œê·¸ë¨',
    summary:'í•œ ë‹¬ê°„ ê¸°í›„ì‹ë‹¨ì„ ì‹¤ì²œí•˜ë©° íƒ„ì†Œ ë°œìêµ­ì„ ì¤„ì´ëŠ” ì²´í—˜í˜• í”„ë¡œì íŠ¸',
    duration:'4ì£¼',
    goal:'ì¼ìƒ ì‹ë‹¨ì—ì„œ ì˜¨ì‹¤ê°€ìŠ¤ë¥¼ ì¤„ì´ê³  ê¸°í›„ ì¹œí™”ì  ì‹ìŠµê´€ì„ ì²´í—˜í•œë‹¤.',
    activities:[
      'ì£¼ 3íšŒ ê¸°í›„ì‹ë‹¨ ì‹¤ì²œ(ì €íƒ„ì†Œ/ë¹„ê±´/ë¡œì»¬í‘¸ë“œ ì¤‘ì‹¬)',
      'íƒ„ì†Œ ë°°ì¶œëŸ‰ ê³„ì‚° ì•±ìœ¼ë¡œ ê°œì¸ ë³€í™” ì¸¡ì •',
      'ê¸°í›„ìš”ë¦¬ ë°œí‘œíšŒ ë° ë ˆì‹œí”¼ ì œì¶œ'
    ],
    plan:[
      {week:'1ì£¼', tasks:['ì‹í’ˆë³„ íƒ„ì†Œë°œìêµ­ í•™ìŠµ','ê¸°í›„ì‹ë‹¨ ë©”ë‰´ ì„ ì •']},
      {week:'2ì£¼', tasks:['ì‹¤ì œ ì‹ë‹¨ ì‹¤ì²œ ë° ê¸°ë¡','ì£¼ê°„ ì‹ë‹¨ ì‚¬ì§„/ê¸°ë¡ ì œì¶œ']},
      {week:'3ì£¼', tasks:['í•™êµ ê¸‰ì‹ ë‚´ ì €íƒ„ì†Œ ë©”ë‰´ ì¡°ì‚¬','ê¸‰ì‹ ë‹´ë‹¹ì ì¸í„°ë·°(ì„ íƒ)']},
      {week:'4ì£¼', tasks:['ê¸°í›„ìš”ë¦¬ ë ˆì‹œí”¼ ì œì‘','ë°œí‘œíšŒ ë° í”¼ë“œë°±']}
    ],
    materials:['ìŠ¤ë§ˆíŠ¸í°(íƒ„ì†Œ ê³„ì‚° ì•±)','ì‹ë‹¨ ê¸°ë¡ì§€ ë˜ëŠ” êµ¬ê¸€í¼','ê°„ë‹¨ ì¡°ë¦¬ë„êµ¬ (í•™êµ ì œê³µ ê°€ëŠ¥)'],
    deliverables:['ê¸°í›„ì‹ë‹¨ ë³€í™” ê·¸ë˜í”„','ê°œì¸ ë ˆì‹œí”¼ 1ê°œ ì œì¶œ','ë°œí‘œ ì˜ìƒ(ì„ íƒ)'],
    verification:'ì•± ê¸°ë¡ ìŠ¤í¬ë¦°ìƒ· ë˜ëŠ” êµ¬ê¸€í¼ ì œì¶œë¡œ ì°¸ì—¬ ì¸ì¦'
  },

  p2: {
    id:'p2',
    title:'â™» ì œë¡œì›¨ì´ìŠ¤íŠ¸ ì‹¤ì²œ ì±Œë¦°ì§€',
    summary:'í•™êµ ë‚´ ì¼íšŒìš© ì¤„ì´ê¸° ìº í˜ì¸(14ì¼) Â· ë¦¬í•„ìŠ¤í…Œì´ì…˜ ì œì•ˆì„œ ì œì‘',
    duration:'14ì¼',
    goal:'í•™êµ ë‚´ í”Œë¼ìŠ¤í‹± ë° ì¼íšŒìš©í’ˆ ì‚¬ìš©ì„ 30% ì´ìƒ ê°ì¶•í•œë‹¤.',
    activities:[
      'ê°œì¸ ì¼íšŒìš©í’ˆ ì‚¬ìš© ê¸°ë¡ ë° ê°ì¶• ì‹¤ì²œ',
      'í•™êµ ë‚´ ìíŒê¸°Â·ë§¤ì  ì“°ë ˆê¸° ì¡°ì‚¬',
      'ë¦¬í•„ìŠ¤í…Œì´ì…˜ ì„¤ì¹˜ ì œì•ˆì„œ ë° ìº í˜ì¸ í¬ìŠ¤í„° ì œì‘'
    ],
    plan:[
      {week:'Day1', tasks:['ê°œì¸ ì“°ë ˆê¸° ë°°ì¶œ ì¸¡ì •(ê¸°ì¤€ì¹˜ ì‚°ì •)']},
      {week:'Day2-10', tasks:['í…€ë¸”ëŸ¬Â·ê°œì¸ì‹ê¸° ì‚¬ìš© ë“± ì œë¡œì›¨ì´ìŠ¤íŠ¸ ì‹¤ì²œ']},
      {week:'Day11-14', tasks:['í•™êµ ì“°ë ˆê¸° ë¶„ì„','ë¦¬í•„ìŠ¤í…Œì´ì…˜ ì œì•ˆì„œ ì‘ì„±']}
    ],
    materials:['í…€ë¸”ëŸ¬Â·ê°œì¸ì‹ê¸°','ê¸°ë¡ì§€Â·ì €ìš¸(ì„ íƒ)','í¬ìŠ¤í„° ì œì‘ ë„êµ¬'],
    deliverables:['ë¦¬í•„ìŠ¤í…Œì´ì…˜ ì œì•ˆì„œ','14ì¼ ì“°ë ˆê¸° ê°ì†Œ ë³´ê³ ì„œ','í¬ìŠ¤í„°Â·ìº í˜ì¸ ì‚¬ì§„'],
    verification:'í•™êµ ì“°ë ˆê¸° ì¸¡ì •í‘œ ë° ì‚¬ì§„ ì œì¶œ, ì œì•ˆì„œ ì œì¶œë¡œ ì¸ì¦'
  },

  p3: {
    id:'p3',
    title:'ğŸŒ± íƒ„ì†Œ í¬ì¸íŠ¸ ì ë¦½ êµìœ¡',
    summary:'ìƒí™œ ë¯¸ì…˜ 10ì¢…ì„ í†µí•´ í¬ì¸íŠ¸ ì ë¦½Â·ë³´ìƒ ì‹œìŠ¤í…œ ìš´ì˜',
    duration:'ì§€ì†í˜•(ì±Œë¦°ì§€)',
    goal:'ìƒí™œ ì† íƒ„ì†Œ ê°ì¶•ì„ ë†€ì´í˜• ë¯¸ì…˜ìœ¼ë¡œ ì „í™˜í•˜ì—¬ ì§€ì†ì  ì‹¤ì²œ ìœ ë„',
    activities:[
      'ë¯¸ì…˜ ìˆ˜í–‰(ì „ë“± ë„ê¸°, ê³„ë‹¨ ì´ìš© ë“±) ì¸ì¦ ë° í¬ì¸íŠ¸ ì ë¦½',
      'í¬ì¸íŠ¸ë¡œ í™˜ê²½ êµ¿ì¦ˆ êµí™˜',
      'í¬ì¸íŠ¸ ë­í‚¹ê³¼ ë‚´ë¶€ ë¦¬ì›Œë“œ ìš´ì˜'
    ],
    plan:[
      {week:'ë¯¸ì…˜ 1~10', tasks:['ê° ë¯¸ì…˜ ìˆ˜í–‰Â·ì‚¬ì§„/QR ì¸ì¦','í¬ì¸íŠ¸ ìë™ ì ë¦½ ë˜ëŠ” ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ê¸°ë¡']},
    ],
    materials:['ìŠ¤ë§ˆíŠ¸í° ì¹´ë©”ë¼','QR ì½”ë“œ ìŠ¤íƒ ë“œ(ê¸°ê´€ ì œê³µ) ë˜ëŠ” êµ¬ê¸€í¼'],
    deliverables:['ê°œì¸ í¬ì¸íŠ¸ ë ˆí¬íŠ¸','ë¯¸ì…˜ ë‹¬ì„±ë¥  ê·¸ë˜í”„'],
    verification:'QR ì²´í¬/ì¸ì¦ìƒ·/êµì‚¬ í™•ì¸ìœ¼ë¡œ í¬ì¸íŠ¸ ì ë¦½'
  },

  p4: {
    id:'p4',
    title:'ğŸ¬ í•´ì–‘ ë™ë¬¼ ë³´í˜¸ í”„ë¡œì íŠ¸',
    summary:'ì‹œë¯¼ê³¼í•™ ë°ì´í„° ìˆ˜ì§‘Â·ì—°ì•ˆ ì“°ë ˆê¸° ìˆ˜ê±°Â·ì „ì‹œê¹Œì§€ ì—°ê²°ë˜ëŠ” í™œë™',
    duration:'4ì£¼',
    goal:'í•´ì–‘ ìƒë¬¼ ì„œì‹ í™˜ê²½ ë³´í˜¸ì™€ ì‹œë¯¼ê³¼í•™ ë°ì´í„° ì œê³µ',
    activities:[
      'ì—°ì•ˆ ì“°ë ˆê¸° ìˆ˜ê±° ë° ë¶„ë¥˜',
      'í•´ì–‘ ë™ë¬¼ ê´€ì°°(ê±°ë¶/ì¡°ë¥˜ ë“±) ê¸°ë¡',
      'ì‹œë¯¼ê³¼í•™ í”Œë«í¼ì— ë°ì´í„° ì—…ë¡œë“œÂ·ì „ì‹œë¬¼ ì œì‘'
    ],
    plan:[
      {week:'1ì£¼', tasks:['í•´ì–‘ ë³´í˜¸ êµìœ¡Â·ì•ˆì „ ìˆ˜ì¹™ í•™ìŠµ']},
      {week:'2ì£¼', tasks:['ì—°ì•ˆ ì“°ë ˆê¸° ì¡°ì‚¬ ë° ì‚¬ì§„ ê¸°ë¡']},
      {week:'3ì£¼', tasks:['ê´€ì°° ë°ì´í„° ì •ë¦¬ ë° ì—…ë¡œë“œ']},
      {week:'4ì£¼', tasks:['ì „ì‹œÂ·ë³´ê³ ì„œ ì œì‘ ë° ë°œí‘œ']}
    ],
    materials:['ì¥ê°‘Â·ì§‘ê²Œ(ì§€ìì²´ ëŒ€ì—¬ ê°€ëŠ¥)','ìŠ¤ë§ˆíŠ¸í°(ì‚¬ì§„ ê¸°ë¡)','ì•ˆì „ ì¥ë¹„(í•„ìš” ì‹œ)'],
    deliverables:['ì‹œë¯¼ê³¼í•™ ë°ì´í„° ì œì¶œ','ì“°ë ˆê¸° ì¡°ì‚¬ ë³´ê³ ì„œ','ì „ì‹œ ì¸í¬ê·¸ë˜í”½'],
    verification:'ì‹œë¯¼ê³¼í•™ í”Œë«í¼(ì˜ˆ: iNaturalist ë“±) ì—…ë¡œë“œ ë˜ëŠ” ì œì¶œ ë³´ê³ ì„œ'
  },

  p5: {
    id:'p5',
    title:'ğŸ¨ í”Œë¼ìŠ¤í‹± ì¬ìˆœí™˜ ì•„íŠ¸',
    summary:'ìˆ˜ê±°í•œ í”Œë¼ìŠ¤í‹±ì„ ì‘í’ˆìœ¼ë¡œ ì¬íƒ„ìƒì‹œí‚¤ëŠ” ì—…ì‚¬ì´í´ë§ ë””ìì¸ ì±Œë¦°ì§€',
    duration:'2~4ì£¼',
    goal:'ë²„ë ¤ì§„ í”Œë¼ìŠ¤í‹±ì„ ì°½ì‘ìœ¼ë¡œ ì „í™˜í•˜ì—¬ ì¬ì‚¬ìš© ê°€ì¹˜ë¥¼ í™•ì‚°',
    activities:[
      'í”Œë¼ìŠ¤í‹± ìˆ˜ê±°Â·ë¶„ë¥˜Â·ì„¸ì²™',
      'ì•„ì´ë””ì–´ ìŠ¤ì¼€ì¹˜Â·í”„ë¡œí† íƒ€ì… ì œì‘',
      'ì‘í’ˆ ì „ì‹œ ë° (ì›í•  ì‹œ) íŒë§¤ ìˆ˜ìµ ê¸°ë¶€'
    ],
    plan:[
      {week:'1ì£¼', tasks:['ìˆ˜ê±°Â·ì•„ì´ë””ì–´ íšŒì˜','ì¬ë£Œ ì¤€ë¹„']},
      {week:'2ì£¼', tasks:['ì œì‘Â·ì¡°ë¦½Â·í…ŒìŠ¤íŠ¸']},
      {week:'3ì£¼', tasks:['ì™„ì„±Â·í¬ì¥Â·ì„¤ì¹˜(ì „ì‹œ ì¤€ë¹„)']},
      {week:'4ì£¼', tasks:['ì „ì‹œÂ·ì „ë‹¬Â·ì„±ê³¼ ê³µìœ ']}
    ],
    materials:['ìˆ˜ê±°ëœ í”Œë¼ìŠ¤í‹±','ì ‘ì°©ì œ/ë°”ì¸ë”/í˜ì¸íŠ¸','ê³µêµ¬(ê°€ìœ„,ê¸€ë£¨ê±´ ë“±)'],
    deliverables:['ì‘í’ˆ 1ì  ì´ìƒ','ì œì‘ ê³¼ì • ì‚¬ì§„/ì˜ìƒ'],
    verification:'ì‘í’ˆ ì‚¬ì§„Â·ì „ì‹œ ê¸°ë¡ ì œì¶œ'
  },

  p6: {
    id:'p6',
    title:'ğŸ« íƒ„ì†Œì¤‘ë¦½ í•™êµ í”„ë¡œì íŠ¸',
    summary:'í•™êµì˜ ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œ ìš”ì¸ì„ ë¶„ì„í•´ COâ‚‚ ì§€ë„ì™€ ì‹¤ì²œì•ˆì„ ë§Œë“ ë‹¤',
    duration:'4ì£¼',
    goal:'í•™êµ ì „ë°˜ì˜ íƒ„ì†Œ ë°°ì¶œ ìš”ì¸ íŒŒì•… ë° ì‹¤íš¨ì„± ìˆëŠ” ê°ì¶• ë°©ì•ˆ ë„ì¶œ',
    activities:[
      'êµì‹¤Â·ê¸‰ì‹ì‹¤Â·ì²´ìœ¡ê´€ ë“± ì—ë„ˆì§€ ì‚¬ìš© ì¡°ì‚¬',
      'ê±´ë¬¼ë³„ COâ‚‚ ë°°ì¶œ ì§€ë„ ì œì‘',
      'í•™ìƒíšŒì™€ í˜‘ë ¥í•œ ì •ì±… ì œì•ˆ ë° ì‹œë²” ì ìš©'
    ],
    plan:[
      {week:'1ì£¼', tasks:['í•™êµ í˜„í™© ì¡°ì‚¬(ì „ë ¥Â·ê¸‰ì‹Â·êµí†µ ë“±)']},
      {week:'2ì£¼', tasks:['ë°ì´í„° ì •ë¦¬Â·ì§€ë„í™”']},
      {week:'3ì£¼', tasks:['ê°ì¶• ë°©ì•ˆ ì„¤ê³„(LED êµì²´, ê¸‰ì‹ ê°œì„  ë“±)']},
      {week:'4ì£¼', tasks:['ê²°ê³¼ ë°œí‘œÂ·í•™ìƒíšŒ/êµì‚¬ í˜‘ì˜']},
    ],
    materials:['ì¸¡ì •ê¸°ê¸°(ì „ë ¥ê³„ ë“±, í•™êµ í˜‘ì¡°)','ì„¤ë¬¸ì§€Â·ì¸í„°ë·° ê¸°ë¡ì§€','ì§€ë„ ì œì‘ íˆ´(êµ¬ê¸€ ë§µ ë“±)'],
    deliverables:['í•™êµ COâ‚‚ ì§€ë„(PDF)','ê°ì¶• ì•¡ì…˜ í”Œëœ'],
    verification:'ì¡°ì‚¬ë³´ê³ ì„œ ë° ë°œí‘œ ìë£Œ ì œì¶œ'
  }
};

/* ---------- UI ë¡œì§ ---------- */
const dashboardContainer = document.getElementById('dashboardContainer');
const selectionCountEl = document.getElementById('selectionCount');
const selectedBadges = document.getElementById('selectedBadges');
const tagList = document.getElementById('tagList');

let selectedSet = new Set();

// ì¹´ë“œ í´ë¦­ í† ê¸€ (ì¹´ë“œ ì˜ì—­ í´ë¦­ ì‹œ ì„ íƒ/í•´ì œ)
dashboardContainer.addEventListener('click', (e) => {
  // ì¹´ë“œ ë‚´ ë²„íŠ¼ í´ë¦­ ë“±ì€ openDetail í•¸ë“¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•˜ë¯€ë¡œ, ì¹´ë“œ ì „ì²´ í´ë¦­ì€ toggle
  const card = e.target.closest('.dash-card');
  if(!card) return;
  // if click 'ìì„¸íˆ ë³´ê¸°' button, it stops propagation so won't reach here
  if(e.target.tagName.toLowerCase()==='button') return;
  toggleCard(card.dataset.id);
});

// í‚¤ë³´ë“œ ì ‘ê·¼: Enter/Spaceë¡œ í† ê¸€
dashboardContainer.addEventListener('keydown', (e)=>{
  if(e.key==='Enter' || e.key===' '){
    const card = e.target.closest('.dash-card');
    if(card) {
      e.preventDefault();
      toggleCard(card.dataset.id);
    }
  }
});

function toggleCard(id){
  const card = document.querySelector(`.dash-card[data-id="${id}"]`);
  if(!card) return;
  if(selectedSet.has(id)){
    selectedSet.delete(id);
    card.classList.remove('selected');
    card.setAttribute('aria-pressed','false');
  } else {
    selectedSet.add(id);
    card.classList.add('selected');
    card.setAttribute('aria-pressed','true');
  }
  refreshSelectionUI();
}

// ì„ íƒ UI ê°±ì‹ 
function refreshSelectionUI(){
  // count
  selectionCountEl.textContent = `${selectedSet.size}ê°œ ì„ íƒë¨`;
  // badges
  selectedBadges.innerHTML = '';
  tagList.innerHTML = '';
  if(selectedSet.size===0){
    selectedBadges.innerHTML = `<div style="color:var(--muted);font-size:13px">ì„ íƒëœ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
    document.getElementById('formSelectedList').textContent = 'ì•„ì§ ì„ íƒëœ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤.';
    return;
  }
  selectedSet.forEach(id=>{
    const p = programs[id];
    const badge = document.createElement('div');
    badge.className='badge';
    badge.innerHTML = `<span>${p.title}</span><button class="x" aria-label="ì œê±°" onclick="removeProgram('${id}', event)">âœ•</button>`;
    selectedBadges.appendChild(badge);

    // tagList
    const tag = document.createElement('div');
    tag.className='badge';
    tag.style.background='transparent';
    tag.style.border='1px solid #e5f6ff';
    tag.style.color='var(--muted)';
    tag.textContent = p.title;
    tagList.appendChild(tag);
  });

  // form-selected list
  document.getElementById('formSelectedList').innerHTML = Array.from(selectedSet).map(id=>`â€¢ ${programs[id].title}`).join('<br>');
}

// ì œê±° ë²„íŠ¼
function removeProgram(id, e){
  e.stopPropagation();
  selectedSet.delete(id);
  const card = document.querySelector(`.dash-card[data-id="${id}"]`);
  if(card) card.classList.remove('selected');
  refreshSelectionUI();
}

/* ---------- ìƒì„¸ ëª¨ë‹¬ ---------- */
const modalBackdrop = document.getElementById('modalBackdrop');
const modalContent = document.getElementById('modalContent');
let currentModalId = null;

function openDetail(id, evt){
  if(evt) evt.stopPropagation();
  const p = programs[id];
  currentModalId = id;
  modalContent.innerHTML = buildDetailHtml(p);
  document.getElementById('modalTitle').textContent = p.title;
  document.getElementById('modalSelectBtn').textContent = selectedSet.has(id) ? 'ì„ íƒ í•´ì œ' : 'ì„ íƒí•˜ê¸°';
  modalBackdrop.style.display = 'flex';
  modalBackdrop.setAttribute('aria-hidden','false');
  // focus
  document.querySelector('#modalBackdrop .close')?.focus();
}

function closeModal(){
  modalBackdrop.style.display='none';
  modalBackdrop.setAttribute('aria-hidden','true');
  currentModalId = null;
}

function toggleSelectFromModal(){
  if(!currentModalId) return;
  toggleCard(currentModalId);
  document.getElementById('modalSelectBtn').textContent = selectedSet.has(currentModalId) ? 'ì„ íƒ í•´ì œ' : 'ì„ íƒí•˜ê¸°';
  // Keep modal open for convenience
}

/* ìƒì„¸ HTML ìƒì„± (program detail) */
function buildDetailHtml(p){
  const activitiesHtml = p.activities.map(a=>`<li>${a}</li>`).join('');
  const planHtml = p.plan.map(w=>`<li><strong>${w.week}:</strong> ${w.tasks.join(', ')}</li>`).join('');
  const materialsHtml = p.materials.map(m=>`<li>${m}</li>`).join('');
  const deliverHtml = p.deliverables.map(d=>`<li>${d}</li>`).join('');

  return `
    <div class="program-detail">
      <div class="detail-block">
        <h4>ìš”ì•½</h4>
        <p>${p.summary}</p>
      </div>

      <div class="detail-block">
        <h4>ëª©í‘œ</h4>
        <p>${p.goal}</p>
      </div>

      <div class="detail-block">
        <h4>ì£¼ìš” í™œë™</h4>
        <ul>${activitiesHtml}</ul>
      </div>

      <div class="detail-block">
        <h4>ì£¼ì°¨ë³„ ê³„íš</h4>
        <ul>${planHtml}</ul>
      </div>

      <div class="detail-block">
        <h4>í•„ìš”í•œ ì¤€ë¹„ë¬¼</h4>
        <ul>${materialsHtml}</ul>
      </div>

      <div class="detail-block">
        <h4>ì‚°ì¶œë¬¼</h4>
        <ul>${deliverHtml}</ul>
      </div>

      <div class="detail-block">
        <h4>ì°¸ì—¬ ì¸ì¦ ë°©ì‹</h4>
        <p>${p.verification}</p>
      </div>
    </div>
  `;
}

/* ---------- ì‹ ì²­ í¼ ëª¨ë‹¬ ---------- */
const formBackdrop = document.getElementById('formBackdrop');

function openApplyForm(){
  // pre-fill selected list
  document.getElementById('formSelectedList').innerHTML = selectedSet.size ? Array.from(selectedSet).map(id=>`â€¢ ${programs[id].title}`).join('<br>') : 'ì•„ì§ ì„ íƒëœ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤.';
  formBackdrop.style.display='flex';
  formBackdrop.setAttribute('aria-hidden','false');
  document.getElementById('name').focus();
}
function closeForm(){
  formBackdrop.style.display='none';
  formBackdrop.setAttribute('aria-hidden','true');
}

/* ì œì¶œ ì²˜ë¦¬ */
function submitApplication(){
  const name = document.getElementById('name').value.trim();
  const school = document.getElementById('school').value.trim();
  const grade = document.getElementById('grade').value.trim();
  const email = document.getElementById('email').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const contactPref = document.getElementById('contactPref').value;
  const message = document.getElementById('message').value.trim();
  const selections = Array.from(selectedSet);

  if(!name || !school || !grade || !email){
    alert('ì´ë¦„, í•™êµ, í•™ë…„/ë°˜, ì´ë©”ì¼ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
    return;
  }
  if(selections.length===0){
    if(!confirm('ì„ íƒí•œ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤. ê·¸ë˜ë„ ì‹ ì²­ì„œë¥¼ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  }

  const submission = {
    id: 'sub_'+Date.now(),
    timestamp: new Date().toISOString(),
    applicant:{name, school, grade, email, phone, contactPref, message},
    programs: selections.map(id=>programs[id]),
  };

  // ë¡œì»¬ ì €ì¥ (ë°ëª¨)
  const existing = JSON.parse(localStorage.getItem('cw_submissions')||'[]');
  existing.push(submission);
  localStorage.setItem('cw_submissions',JSON.stringify(existing, null, 2));

  // ë‹«ê³  í™•ì¸ ëª¨ë‹¬
  closeForm();
  openConfirm(submission);
}

/* ---------- ì‹ ì²­ í™•ì¸ ëª¨ë‹¬ ---------- */
const confirmBackdrop = document.getElementById('confirmBackdrop');
function openConfirm(sub){
  // build summary html
  const html = `
    <div style="display:flex;flex-direction:column;gap:10px">
      <div class="summary"><strong>ì ‘ìˆ˜ ID:</strong> ${sub.id} Â· <strong>ì‹œê°„:</strong> ${new Date(sub.timestamp).toLocaleString()}</div>
      <div><strong>ì‹ ì²­ì:</strong> ${sub.applicant.name} (${sub.applicant.school}, ${sub.applicant.grade})</div>
      <div><strong>ì—°ë½:</strong> ${sub.applicant.email} ${sub.applicant.phone ? 'Â· '+sub.applicant.phone : ''} Â· ${sub.applicant.contactPref}</div>
      <div><strong>ì„ íƒ í”„ë¡œê·¸ë¨(${sub.programs.length}):</strong><ul>${sub.programs.map(p=>`<li>${p.title}</li>`).join('')}</ul></div>
      <div><strong>ì¶”ê°€ ë©”ì‹œì§€:</strong><div style="border-left:3px solid #eaf7ff;padding:8px 12px;border-radius:6px">${sub.applicant.message || 'ì—†ìŒ'}</div></div>
    </div>
  `;
  document.getElementById('confirmContent').innerHTML = html;
  // store last submission for download
  window._lastSubmission = sub;
  confirmBackdrop.style.display='flex';
  confirmBackdrop.setAttribute('aria-hidden','false');
}

function closeConfirm(){
  confirmBackdrop.style.display='none';
  confirmBackdrop.setAttribute('aria-hidden','true');
}

/* ë‹¤ìš´ë¡œë“œ (JSON) */
function downloadSubmission(){
  const sub = window._lastSubmission;
  if(!sub) return;
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(sub, null, 2));
  const a = document.createElement('a');
  a.setAttribute('href', dataStr);
  a.setAttribute('download', `${sub.id}_submission.json`);
  document.body.appendChild(a);
  a.click();
  a.remove();
}

/* í´ë¦¬ì–´, ì„ íƒ ì´ˆê¸°í™” */
function clearAll(){
  if(!confirm('ì„ íƒì„ ëª¨ë‘ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  selectedSet.clear();
  document.querySelectorAll('.dash-card').forEach(c=>c.classList.remove('selected'));
  refreshSelectionUI();
}

/* ì´ˆê¸° ì„ íƒ UI ì„¸íŒ… */
refreshSelectionUI();

/* Accessibility: ESCë¡œ ëª¨ë‹¬ ë‹«ê¸° */
document.addEventListener('keydown', (e)=>{
  if(e.key==='Escape'){
    closeModal();
    closeForm();
    closeConfirm();
  }
});
</script>
</body>
</html>
